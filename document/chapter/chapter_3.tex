\chapter{Modeling of random alloys}
\label{sec:SQS}

The disordered structure of high-entropy alloys, in which the alloying elements occupy lattice sites by a random probability, pose a problem on conventional numerical methods. Density functional theory in particular rely heavily on the periodicity of crystalline solids, as we will discover later. In a brute force approach, this could be solved by randomly distribute the solute and solvent atoms over the lattice sites of a large supercell, and average the energy and related properties over a large number of such supercells with varying distributions. Obviously, despite of the computational means accessible today, this approach is far too computationally demanding. Today, there exists a number of possible methods to more efficiently study such structures. Examples are the Virtual Crystal Approximation (VCA), Coherent Potential Approximation (CPA), Special Quasi-random Structure (SQS), and hybrid Monte-Carlo/Molecular Dynamics. (MC/MD). A brief overview of the different methods are given in for example \cite{sqsIntro}. In this project, we will employ the SQS method due to both easy to use implementation and interpretation in the computational framework of this project, in addition to other benefits that will become clear after the following sections.             

\section{The Special Quasi-random Structures method}
In the original paper published in 1990 describing the SQS method \cite{sqsfull}, it was proposed a selective occupation strategy to design special periodic quasi-random structures that exceeded previous methods in both accuracy and cost. The key concept was to create a periodic unit cell of the various components in a finite N lattice site single configuration such that the structure most closely resemble the configuration average of an infinite perfect random alloy. In an attempt to work under the 50 lattice sites boundary of ab initio methods at that time, the working theory was that if one can resemble an infinite perfect random alloy by a periodic finite $N$ cell, also the electronic properties would be similar between the two. The solution to this problem, was that for each $N$, ie lattice site, to minimize the difference of structural correlation functions between the approximated cell and the perfect random alloy. There are obviously errors involved with approximating a random alloy by a periodic structure, but by a hierarchical relation to the properties of the material, interactions between distant sites offer negligible small contributions to the total energy of the system. Thus, the aim of the SQS method is focused around optimizing the correlations within the first few shells of a given site. 

\subsection{Mathematical description}

Below we give a summary of the mathematical description of the special quasi-random structures method, and cover various statistical methods and notations. For a more comprehensive discussion on these topics and the SQS method, we refer the reader to the article "Electronic properties of random alloys: Special quasirandom structures", by Wei \cite{sqsfull}.  

The different possible atomic configurations are denoted $\sigma$. The physical properties of a given configuration is $E(\sigma)$, and $<E>$ is the ensemble average over all configurations. In practice, this quantity is unfeasible in terms of computational cost, seeing as the average require calculations and relaxations of all possible configurations, for a binary alloy this is $2^N$ for a fixed N number of lattice sites. A solution to this is to use the theory of cluster expansions and discretize each configuration into "figures" $f$. A figure in the lattice is defined in terms of the number of atoms at each vertex $k$, the order of neighbor distances separating them $m$, and position in the lattice $l$. Further, each site in the figure is assigned a spin value $\hat{S_i}$ to denote which element it holds (+1,-1 for a binary alloy). By defining the spin product of spin variables in a figure at lattice position $l$ as $\Pi_f(l, \sigma)$, we can write the average of all locations in the lattice of a given figure $f$ as
\begin{equation}
    \boldsymbol{\Pi}_f(\sigma) = \frac{1}{ND_f} \sum_l \Pi_f (l,\sigma),
\end{equation}
where $D_f$ is the number of equivalent figures per site. The brilliance of this notation is that we now can express the physical property $E(\sigma)$ in terms of the individual contributions $\epsilon_f$ of a figure $f$.
\begin{equation}
    E(\sigma) = \sum_{f,l} \Pi_f(l, \sigma) \epsilon_f(l)
\end{equation}
The quantity $\epsilon_f$ is called the "effective cluster property" and is defined as (for a random binary alloy $A_{1-x}B_x$)
\begin{equation}
    \epsilon_f(l) = 2^{-N}\sum_\sigma^{2^N} \Pi_f (l,\sigma) E(\sigma).
\end{equation}
Inserting the equation for $\boldsymbol{\Pi}_f$ into that of $E(\sigma)$, we can describe the previous cluster expansion of $E(\sigma)$ as
\begin{equation}
    E = N\sum_f D_f<\boldsymbol{\Pi_f}>\epsilon_f.
\end{equation}
Thus, we have successfully managed to reduce the expensive task of sampling all $E(\sigma)$ into calculating the effective cluster properties and summing over all types of figures. Remembering that $E(\sigma)$ can relate to many physical properties, the most common and applied case is that $E(\sigma)$ is the total energy, while $\epsilon_f$ are the many body interaction energies. The cluster expansion above converge rather quickly with increasing number of figures, an effective method is thus to select a set of configurations to evaluate the effective cluster properties. The next step is to select a finite largest figure denoted $F$, and "specialize" the cluster expansion to a set of $N_s$ periodic structures ${\sigma} = ${s} to obtain the two expressions for $E(s)$ and $\epsilon_f$ using matrix inversion to obtain the result for $\epsilon_f$:
\begin{align}
E(s) &= N\sum_{f}^{F} D_f \boldsymbol{\Pi}_f (s)\epsilon_f \\     
\epsilon_f &= \frac{1}{ND}\sum_{s}^{N_s}[\boldsymbol{\Pi}_f (s)]-1E(s)
\end{align}
Assuming now that the sum of figures $F$ and $N_s$ periodic structures are well converged, $E(\sigma)$ can be rewritten as a superposition of $E(s)$ as
\begin{align}
    E(\sigma) &= \sum_{s}^{N_s}\xi_s(\sigma)E(s) \\
    \xi_s(\sigma) &= \sum_{f}^{F}[\boldsymbol{\Pi}_f(s)]^{-1}\boldsymbol{\Pi}_f(\sigma),   
\end{align}
where $\xi$ are the weights. Hence, we have effectively reduced the problem to a convergence problem of the number of figures $F$ and structures $N_s$. This can be easily solved given that we are dealing with periodic crystal structures ${s}$ that can employ the general applications of ordered structures from ab initio methods, and increasing $F$ until the truncation error falls bellow a desired threshold. However, this approach requires that the variance of the observable property is much lower than the sample mean, otherwise one would have to employ a much bigger sample size to reach statistical convergence. Because of the different relationships between various physical properties and the correlation functions, one observe different convergence depending on the meaning of $E$. The idea behind SQS was therefore to design single special structures with correlation functions ${\boldsymbol{\Pi}_f(s)}$ that most accurately match those of the ensemble average of a random alloy $<\boldsymbol{\Pi}_f>_R$. 

The correlation functions of an perfect random infinite alloy, denoted as $R$ is defined as
\begin{equation}
    \boldsymbol{\Pi}_{k,m}(R) = <\boldsymbol{\Pi}_{k,m}>_R = (2x-1)^l ,
\end{equation}
with $k, m$ defined as before and $x$ as the composition ratio of the alloy. In the case of an equimolar alloy ($x=\frac{1}{2}$), the functions equals 0 for all $k$ except $<\boldsymbol{\Pi}_{0,1}>_R = 1$. If we now randomly assign either atom A or B to every lattice site, for a sufficiently large value of N, the goal is then to create a single configuration that best match the random alloy. Keeping with the $x=\frac{1}{2}$ case, the problem is now that even though the average correlation functions of a large set of these structures approaches zero, like for the random alloy. The variance of the average is nonzero meaning that a selected structure of the sample is prone to contain errors. The extent of these errors can be evaluated from the standard deviations
\begin{equation}
    \nu_{k,m}(N) = |<\boldsymbol{\Pi}^{2}_{k,m}>|^{\frac{1}{2}} = (D_{k,m}N)^{-\frac{1}{2}}.
\end{equation}
Given the computational aspects, its obvious that economical structures with small N are prone to large errors. In fact, in some cases these errors can result in correlation functions centering around 1, as opposed to 0 for a perfect random alloy.  

The degree to which a structure $s$ fails to reproduce the property $E$ of the ensemble-averaged property of the random alloy can be described by a hierarchy of figures
\begin{equation}
    <E> - E(s) = \sum_{k,m}' D_{k,m}[(2x-1)^k-\boldsymbol{\Pi}_{k,m}(s)]\epsilon_{k,m}, 
\end{equation}
the prime is meant symbolize the absence of the value $0,1$ for $k,m$. The contribution from the figure property $\epsilon$ is smaller in larger figures. In disordered systems the physical property "E" at a given point R falls of exponentially as $|R-R'|/L$, where L is a characteristic length scale relating to the specific property. Using this, the approach of SQS is to specify a set of correlation functions that hierarchically mimic the correlation functions of the random alloy. Meaning that it prioritize the nearest neighbor interactions. With the set of functions decided on, the objective it finally to locate the structures that correspond to the selected structures. 

With this approach, \cite{sqsfull} managed by mimicking the correlation functions exact for the first two shells, to reduce the computational measures of an accurate model. In this exact study, they matched the results of an $N \rightarrow \infty$ alloy, by an $N=8$ SQS. In the final section of this chapter, to recover from this lengthy mathematical derivation, we will take a look at recent advances made to the special quasi-random structures method and applications to high-entropy alloys. 

\newpage
\subsection{Applications to high-entropy alloys}
The success of the SQS method is in large part related to to the fact that we can create simple periodic structures, this allows for the use of standard DFT methods to calculate properties such as the total energy, charge density and electronic band structure \cite{sqs_dos}, \cite{sqs_bg}. Despite for the method being developed in mind of a binary random alloy, the approach has successfully been extended to multi-component alloys as well. However, certain obstacles arise when trying to apply the SQS model to high-entropy alloys. An exhaustive analysis discussing several of these factors and comparing the SQS method to alternative methods is presented in \cite{hea2016_ch10}, by M.C Gao et al. In this section we will go through some of the major findings of his research.

The first initial concern is the size of the supercell. This parameter needs to be balanced between accuracy and cost. A larger SQS cell consisting of a greater number of atoms better encapsulate the disordered structure of HEAs, but both the generation and simulation of such large SQSs come with an increased computational cost. M.C Gao discovered a sensitivity between the registered stability and predicted crystal structures of \ch{CoCrFeNi} and \ch{CoCrFeMnNi} HEAs, and the SQS size. Experimentally, both of these are stabilized in FCC. By calculating the enthalpy of formation, it was found that SQSs consisting of less than 64 atoms wrongly predicted the HCP structure as the most stable structure, while larger SQSs correctly predicted the FCC structure. Furthermore, similar outcomes was found with respect to the pair distribution functions of the \ch{CoCrFeMnNi} HEA as well. This is displayed in figure 3.1, where the Cr-Mn bond is clearly much better modeled in the larger SQS model. 

\begin{figure}[H]
\begin{subfigure}{.5\textwidth}
\includegraphics[width=\textwidth]{theory/PDF_small.png}
\caption{20 atom SQS}	
\end{subfigure}
\begin{subfigure}{.5\textwidth}
\includegraphics[width=\textwidth]{theory/PDF_big.png}
\caption{250 atom SQS}
\end{subfigure}
\caption{Pair distribution functions of (a) 20-atom and (b) 250-atom SQSs of \ch{CoCrFeMnNi}. Figure adopted from \cite{hea2016_ch10}.}
\end{figure}
     
It was also observed a similar dependence to the SQS size for the entropy and mechanical properties, however these topics are not relevant for this project and will thus not be elaborated further. 

Compared to hybrid Monte-Carlo/Molecular Dynamics, we observe from the density of states of the \ch{CoCrFeMnNi} HEA (figure 3.2), that the SQSs method measures up very well with the much more complicated method. Furthermore, the SQS method yields  comparative outcomes in terms of the pair distribution functions to MC/MD, as seen in figure 3.3 for HCP \ch{CoOsReRu}.  
      
\begin{figure}[H]
\centering
\includegraphics[width=.6\textwidth]{theory/SQS-MCMD_DOS.png}
\caption{Density of states of FCC CoCrFeNi with MC/MD and SQS. figure adopted from \cite{hea2016_ch10}.}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{theory/SQS-MCMD_PDF.png}
\caption{Pair distribution functions of HCP CoOsReRu, from MC/MD and SQS simulations. Figure adopted from \cite{hea2016_ch10}.}
\end{figure}

The discrepancy in the PDFs between MC/MD simulations and SQS, arises from the fact that SQS fails to include inter-atomic interactions and preferences to the same extent as MC/MD. This is seen in figure 3.3 for the HCP CoOsreRu alloy, in which clear preference of Co-Os and Re-Ru pairs is apparent from MC/MD simulations but not in the SQS model. Compared to the Coherent Potential Approximations, there is indication that the SQS method is less equipped for dealing with specific compositions such as \ch{A{1/3}BCDE} structures, and notably worse performance for paramagnetic materials. 

We have seen up until this point that the SQS method utilizes an intelligent approach which allows for simple implementation and calculations while providing results mostly on par to other more intricate and complex methods. One distinct factor concerning SQS that does not apply for CPA and MC/MD, is that one compound can obtain a number of unique configurations (SQSs). For example, quaternary and quinary alloys make for 24 and 124 unique configurations respectively, resulting in an uncertainty of the energy regarding the different configurations. This effect is most prominent in anisotropic lattices such as HCP and alloys with chemically dissimilar constituents, and particularly in smaller SQSs. 
 
Despite of its flaws, especially in recent years SQS have emerged as a viable and trusted method of modeling disordered structures such as HEAs. This is down to both the increasingly available computational power and improvements to the SQS method. The latter in particular saw a boost in 2013 with the introduction of the MC-SQS method \cite{mcsqs2013}, short for Monte-Carlo Special Quasirandom Structures. Contrary to the original SQS method that seeks to minimize the difference between the correlation functions of the approximated cell and the true random alloy, this method employ monte-carlo simulations to perfectly match a maximum number of correlation functions. Furthermore, emphasizes an efficient and fast implementation in addition to an exhaustive unbiased search of possible atomic configurations. Following, this is the preferred and most widely used implementation of the SQS method. This has resulted in an increased number of studies utilizing SQSs to investigate high-entropy alloys in recent times, for instance \cite{WANG2021128754}, \cite{WEI2021167432}, \cite{RASHID2014285}, and \cite{SORKIN2021160776}.   






























































