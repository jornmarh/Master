\chapter{Density Functional Theory}
\label{sec:DFT}

The density functional theory (DFT) is recognized as a overwhelmingly successful method in quantum chemistry and the overall study and understanding of matter. As illustrated in figure 5.1 this is a tremendously popular method with rapid growth to this day due to improvements to both the method and computational power. \textbf{More elaborate introduction, write later.}
\begin{figure}[H]
\includegraphics[width=\textwidth]{theory/dftScope.png}
\caption{Number of DFT studies per year from 1980 to 2021. \textbf{Add reference?}}
\end{figure}

The concept of the density functional theory is to efficiently solve the problems posed by quantum physics, most notably the many-particle Shr\"{o}dinger equation. Thus in this section we will begin by reviewing some central concepts of quantum physics before presenting the main Hohenberg-Kohn formulation of DFT. The content in this part is inspired from the lecture notes [REF] written by Clas Persson in the course FYS-MENA4111 at University of Oslo.

Quantum mechanics is the engine of density functional theory and to truly understand the method and it's limitations a knowledge of the engines is necessary. 
\section{Review of Quantum Mechanics}

\subsection{The Shr\"{o}dinger equation}
All theoretical information of a material can be derived from the Shrodinger equation, which came to the world in 1926. Since this the major question how been how this equation can be solved. 
The time-dependent Schr\"{o}dinger equation for one electron is given bellow

\begin{equation}
    i\hbar\frac{\partial}{\partial t}\Psi(\vec{r}, t) = \hat{H}(\vec{r},t)\Psi(\vec{r}, t).
\end{equation}

This equation consists of the the wavefunction $\Psi(\vec{r},t)$ which describe the electron, and the Hamiltonian $\hat{H}(\vec{r},t)$ where $\vec{r}$ and $t$ is the spatial position and time respectively. The Hamiltonian describes the systems total energy by a kinetic part $T = \frac{-\hbar^2\nabla^2}{2m_e}$, where $m_e$ is the electron mass and $\hbar$ is the constant, and a potential energy operator U, typically an external potential denoted $V_{ext}(\vec{r}, t)$. Wavefunctions of stationary states are eigenfunctions of the Hamiltionian and are denoted as $\psi_{\kappa}(\vec{r}, t)$ with an energy eigenvalue $\epsilon_{\kappa}$. The subscript $\kappa$ indicate that the wavefunction correspond to the $\kappa$ eigenstate. Above we included the time-dependent Shrodinger equation, but almost all cases involving Quantom physics employ rather the time-independent Shroidinger eqaution in which the external potential is independent of time. Bellow we show the time-independent Shrodinger equation for the eigenvalues $E_k$ of the $k$-th eigenfunction $\psi_k(\vec{r})$

\begin{equation}
	\left(-\frac{\hbar^2\nabla^2}{2m_e} + V_{ext}(\vec{r}) \right)\psi_{\kappa}(\vec{r}) = E_k \psi_k(\vec{r})
\end{equation}

Solving the single electron time-independent equation often results in infinite eqienstates that the electron can occupy. The most probable state the electron occupy is the lowest energy state called the ground state, this state is indicated by $\kappa = 0$. Extending to a system comprised of multiple particles we have the many-body Shr\"{o}dinger equation with the many-body wavefunction 

The many-body wavefunction is defined as
\begin{equation}
\Psi^{en}(\vec{r}, \vec{R}) = \Psi^{en}(\vec{r_1}, \vec{r_2}, \dots \vec{r_{N_e}}, \vec{R_1}, \vec{R_2}, \dots \vec{R_{N_n}}),
\end{equation}
 where $r_j$ denote the coordinates of the j:th electron and likewise $R_{\alpha}$ describe the coordinates of the $\alpha$:th nucleus, and the subscript "en" subscript means that we consider both the electrons and nuclei. Furthermore we have the many-body Hamiltonian $H^{en}$, composed of the kinetic energy of $N_e$ electrons $T_e$, the interaction energy between electrons $U_{ee}$, the kinetic energy of $N_n$ nuclei, the coulomb interaction between nuclei $U_{nn}$, and finally the attractive interaction between nuclei and electrons $U_{en}$. In the many-body Hamiltonian the following notations are used $m_n$ = nuclei mass, $q$ = particle charge, $\alpha$ = nuclei number, $Z_a$ = atom number of nuclei $\alpha$. In final we get 
\begin{align}
    \hat{H} &= T_e + T_n + U_{ee} + U_{nn} + U_{en} \\
    \begin{split}
        &= -\sum_{j=1}^{N_e}\frac{\hbar^2\nabla_j ^2}{2m_e} - \sum_{\alpha=1}^{N_n}\frac{\hbar^2 \nabla_\alpha ^2}{2m_n} + \sum_{j=1}^{N_e}\sum_{j'<j}\frac{q^2}{|r_j - r_{j'}|} \\
    &+ \sum_{\alpha=1}^{N_n}\sum_{\alpha' < \alpha}\frac{q^2Z_\alpha Z_{\alpha'}}{R_\alpha - R_{\alpha'}} -\sum_{j=1}^{N_e}\sum_{\alpha=1}^{N_n}\frac{q^2Z_\alpha}{|r_j - R_\alpha|},
    \end{split}
\end{align} 
 
and the many body Schrodinger equation with total energy eigenvalue $E_{\kappa}^{en}$ of the whole system in eigenstate $\kappa$
 
\begin{equation}
H^{en}\Psi^{en}_{\kappa}(\vec{r}, \vec{R}) = E_{\kappa}^{en}\Psi_{\kappa}^{en}(\vec{r}, \vec{R}).
\end{equation}

The first step to solving the many-body problem is to obtain an exact expression for the many particle wavefunction $\Psi^{en}(\vec{r}, \vec{R})$ in order to apply the single-particle operators in equation (5.4). If we consider a simplified system consisting of just two electrons, the problem is reduced to finding $\Psi_{\kappa}(\vec{r_1}, r_2)$ that is a function of $psi_1(\vec{r_1})$ and $\psi_2(\vec{r_2})$. In the Hartree approach this is solved by considering the two electrons to be independent of each-other, and employ variable separation to express the two particle wavefunction as

\begin{equation}
\Psi_{\kappa}(\vec{r_1}, r_2) = psi_1(\vec{r_1})psi_2(\vec{r_2}).
\end{equation}

The limitation of the Hartree approach is that the electrons, which are fermions, in this formulation are distinguishable and hence does not obey the Pauli exclusion principle of fermions. This is corrected by the Harte-Fock approximation which introduces a spin function $\chi_{mp}(s_1, s_2)$ to equation (5.4) to make it anti-symmetric with respect to the particle coordinates. The Hartree-Fock approximation is expressed as

\begin{equation}
\Psi_{\kappa}(\vec{r}_1, \vec{r}_2) = \frac{1}{2} \left\{ \psi_1(\vec{r}_2) \psi_2(\vec{r}_2) \pm \psi_1(\vec{r}_2) psi_2(\vec{r}_1) \right\} \chi_{\mp}(s_1, s_2).
\end{equation}  

The difference in energy from the improved wavefunction in Harte-Fock compared to the Hartee approximation is called the exchange energy. Note however that Hartee-Fock is not a complete description either as it fails to model the electron correlations. For the next step in the derivation of the Kohn-Sham density functional theory we need to make use the variational principle. This is an efficient method for finding the ground state properties of a system. The method states that the energy of any trial wavefunction will always be higher than the ground-state energy $E_0$, ie
\begin{equation}
    E_0 = \langle\psi_0|H|\psi_0\rangle \leq \langle\psi|H|\psi\rangle = E
\end{equation}
This enable us to find the ground state energy and corresponding wavefunction by a minimization technique. We will apply the variational principle to find the ground state energy $\Psi_0(\vec{r}_1, \vec{r}_2)$ of a two electron Hartree problem. Here we skip the result and simply state the result. In final we get the Hartree single-electron equation defined as

\begin{equation}
\left[ -\frac{\hbar^2\nabla^2}{2m_e} + V_H(\vec{r}) - V_{SI}(\vec{r}) + V_{ext}(\vec{r}) \right] \psi_j(\vec{r}) = \epsilon_j \psi_j(\vec{r}), j = 1, 2.
\end{equation}
 
From this expression we can further find the ground state total energy as 
 
\begin{equation}
E = \sum_j \epsilon_j - \frac{1}{2} \int \left( V_H(\vec{r}) - V_{SI}(\vec{r}) \right) n(\vec{r})d\vec{r}.
\end{equation} 
 
In the above expressions $V_H$ and $V_{SI}$ are the Hartree potential and the self-interaction potential respectively. The self-interaction potential is subtracted in the equations to account for that an electron can not interact with itself. The above statements can also be applied for Hartree-Fock systems and is easily extended to a $N_E$ electron problem by setting $j$ in Eq. (5.4) equal to $j = 1, 2, \dots N_e$. In this case it's common to also include the self-interaction term to simply the calculations by making the total potential in Eq. (5.10 ) equal for all electrons, however this introduces a self-interaction error in the approximation. Moreover,by employing the variational principle, the many body equation has been transformed to a set of single electron equations, however the use of the variational principle means that this expression is valid only for the ground state. 

A second essential approximation to the many-body equation is the Born-Oppenheimer approximation. This makes a very cleaver assumption that significantly simply the equation. Given that the electron mass is negligibly small in comparison to that of a nuclei, we can treat the nuclei as point charges, enabling us to divide the eigenfunction into a separate electronic and nuclear part, in other words

\begin{equation}
    \Psi_{k}^{en}(\vec{r}, \vec{R}) \approx \Psi_k(\vec{r}, \vec{R}) \Theta_k(\vec{R}),
\end{equation}

where $\Psi_k(\vec{r}, \vec{R})$ is the electronic part and $\Theta_k(\vec{R})$ the nuclear part. The $\vec{R}$ dependence in $\Psi_k(\vec{r}, \vec{R})$ originate from the fact that electrons can respond instantaneously to updated positions of the nuclei. Writing this in terms of the Hamiltonian give

\begin{align}
    &\left( T_{e} + U_{ee} + U_{en} \right) \Psi_k(\vec{r}, \vec{R}) = E_k(\vec{R})\Psi_k(\vec{r}, \vec{R}) \\
    &\left( T_{n} + U_{nn} + E_k(\vec{R}) \right) \Theta(\vec{R}) = E_{k}^{en}(\vec{R})\Theta_k(\vec{r}, \vec{R}).
\end{align}

We observe that the two sections are interrelated through the electronic energy $E_k(\vec{R})$. Furthermore, the left hand side of the nuclear part can be simplified to $U_{nn} + E_k(\vec{R})$, assuming that the kinetic energy of point charges is zero.

With the Hartree, Hartree-Fock and Born-Oppenheimer approximations we are finally ready to solve the many-body Shodinger equation. The first factor we need to consider is how the gigantic number of terms in the calculation can be solved numerically. As an example, a material of volume equal to $1cm^3$ contain about $10^{23}$ nucleus and electrons which makes for nearly $10^{40}$ terms to solve in Eq.(5.6). Secondly and more important, how does the many-particle wavefunction $\Psi^{en}$ depend on the single-particle wavefunctions, and how can we operate the Hamiltonian on $\Psi^{en}$? This is where the density-functional theory enters. When people today mention DFT, most of the time they mean the Kohn-Sham density functional theory that combines the concept of the original density functional theory of relating the many-body wavefunction to the total energy through $n(\vec{r}) = |\Psi(\vec{r})|^2$, where n is the electron density. And the Kohn-Sham equations that approximate $\Psi^{en}$ by ...

\section{Fundamentals of Density-Functional Theory}
The density functional theory was developed by Hohenberg and Kohn in 1964 and revolved around the fact that the ground-state density can be expressed in terms of the ground-state wavefunction. We have
\begin{equation}
    n_0(r) = |\Psi_0(r)|,
\end{equation}
furthermore the theorem states that all ground-state physical properties can be found as unique functionals of the ground-state density. The biggest upside of this, is that instead of trying to solve the many-body Shr\"{o}dinger equation to obtain the ground-state wavefunction, we have reduced the computational complexity from $3N_e$ to $3$. Thus, the Hohenberg and Kohn density functional theory makes for a promising and effective method to obtain the ground-state properties of a system, given that the exact electron density functional is known. However, this is still 60 years later unknown. 

The density functional theory build on two specific theories, called the Hohenberg-Kohn theorems. They are:
\begin{enumerate}
    \item For any system of interacting particles in an external potential $V_{ext}$, the density is uniquely determined.
    \item There exists a variational principle for the energy density functional such that, if $n$ is not the electron density of the ground-state, them $E[n_0] < E[n]$.
\end{enumerate}
The proof behind both theorems can be found in appendix .. A direct result of the second theorem is the energy can be described as a function of the density
\begin{equation}
    E[n] = T[n] + U_{ee}[n] + U_{en}[n],
\end{equation}
where the first two terms $T[n]$ and $U_{ee}[n]$ make up the Hohenberg-Kohn functional. 

We know move on to the Kohn-Sham equations, in which Kohn and Sham expressed the exact ground-state density from Hartree type wavefunctions. 
\begin{equation}
    \Psi(\vec{r}_1, \vec{r}_2 , .., \vec{r}{N_e}) = \psi_1^{KS}(\vec{r}_1)\psi_2^{KS}(\vec{r}_2)...\psi_{N_e}^{KS}(\vec{r}_{N_e})
\end{equation}
In which, $\psi_j^{KS}$ are auxiliary independent single-particle wavefunctions. We know modify the equation for total energy as a function of density defined by the second theorem, to include the single auxiliary wavefunctions and their corresponding kinetic energy and interaction energy. We get:
\begin{equation}
    E[n] = T_s[n] + U_s[n] + U_{en}[n] + (T[n] - T_s[n]) + (U_{ee}[n] - U_s[n]).
\end{equation}
with the s subscript denoting the single particle wavefunctions. The latter two terms are known as the exchange-correlation energy $E_{xc}$
\begin{equation}
    E_{xc}[n] = \Delta T + \Delta U
\end{equation}

This term is responsible for the many-electron interaction. The complete total energy functional can now be expressed as
\begin{equation}
    \begin{split}
    E[n] &= \overbrace{\sum_j \int \psi_j^{KS*}\frac{-\hbar^2 \nabla^2}{2m}\psi_j^{KS}d\vec{r}}^{T_s[n]} + \overbrace{\frac{1}{2}\frac{1}{4\pi \epsilon_0} \int \int q^2 \frac{n(\vec{r})n(\vec{r}')}{|\vec{r} - \vec{r}'|}d\vec{r}\vec{r}'}^{U_s[n]} \\ 
        &+ \underbrace{\int V_{en}(\vec{r}n(\vec{r})d\vec{r}}_{U_en[n]} + \underbrace{(T[n] - T_s[n]) + (U_{ee}[n] - U_s[n])}_{E_{xc}[n]}
    \end{split}
\end{equation}

Finally we write the complete expression for the Kohn-Sham single-electron equations given an exact exchange-correlation energy and utilizing the variational principle described previously
\begin{equation}
    \bigg\{ -\frac{\hbar^2}{2m_e}\nabla^2_s + v_H(\vec{r}) + V_{en}(\vec{r}) + V_{xc}(\vec{r} \bigg\}\psi_s^{KS}(\vec{r}) = \epsilon_s^{KS}(\vec{r})\psi_s^{KS}(\vec{r}),
\end{equation}
Define $V_H$, and $V_{xc}$ and mention that the former include self interaction that can be accounted for in XC functional. Finally, the total energy of the many-electron system is defined as
\begin{equation}
    E[n] = \sum_j \epsilon_j^{KS} - \frac{1}{2}\frac{1}{4\pi\epsilon_0} \int \int q^2 \frac{n(\vec{r})n(\vec{r}')}{|\vec{r} - \vec{r}'|}d\vec{r}d\vec{r}' + E_{xc}[n] - \int V_{xc}(\vec{r})n(\vec{r})d\vec{r}.
\end{equation}
This is the fundamental working principle of the density functional theory and Kohn-Sham equations.

\section{Limitations of DFT}
\begin{itemize}
    \item Local minima method
    \item Not exact $V_{xc}$, means we must compromise between accuracy and cost, and choose between the different methods for specific application. There is no one best overall method that is superior for all purposes. 
    \item kohn-sham eigenfunctions are not the exact eigenfunctions. 
    \item DFT in its original formulation is only valid for the ground state. Thus excited state application of DFT, all though very possible have a lesser theoretical footing.
    \item The band-gap calculation is also complicated by the self-interaction error which arises in the occupied states in standard DFT, and in the unoccupied states in Hartree-Fock. If you consider the "true" band-structure, then semi-local DFT has a spurious self-interaction in the occupied states, which over-delocalises them and forces them up in energy, thus reducing the band-gap; Hartree-Fock has the same problem but for the *unoccupied* states, so they are over-delocalised and forced up in energy, which increases the band-gap. \cite{bandgap_dft_forum}
    \item References on the band gap with DFT based methods \cite{bandgap_dft_1}, \cite{bandgap_dft_2}
\end{itemize}

